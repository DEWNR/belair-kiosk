<!DOCTYPE html>
<html data-ng-app="kioskApp" data-ng-controller="mainController">
    <head>
        <meta charset="utf-8">

        <meta http-equiv="X-UA-Compatible" content="IE=edge">

        <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1.0">

        <title></title>
    </head>
    <body>

        <ul>
            <li><a href="#/vehicle-entry">Vehicle entry</a></li>
            <li><a href="#/tennis-courts">Tennis courts</a></li>
            <li><a href="#/facilities">Facilities</a></li>
        </ul>

        <p>
            Current Render Action:
            <strong ng-bind="renderAction">Unknown</strong>
        </p>


        <div ng-switch on="renderPath">

            <div id="bookeasy__details-gadget"></div>

        </div>


        <script src="//gadgets.impartmedia.com/gadgets.jsz?key=d5192d41822d0c987a0610af120d29bf"></script>

        <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.8/angular.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.8/angular-route.min.js"></script>

        <script>

            var kioskApp = angular.module('kioskApp', ['ngRoute']);

            // configure our routes
            kioskApp.config(function($routeProvider) {

                $routeProvider

                    .when('/home', {
                        action: 'home.default'
                    })

                    .when('/vehicle-entry', {
                        action: 'vehicle-entry.gadget'
                    })

                    .when('/tennis-courts', {
                        action: 'tennis-courts.gadget'
                    })

                    .when('/facilities', {
                        action: 'facilities.gadget'
                    })

                    .otherwise({redirectTo: '/home'});
            });


            // create the controller and inject Angular's $scope
            kioskApp.controller('mainController', function( $scope, $route, $routeParams ) {
                render = function() {

                    // currently selected route.
                    var renderAction = $route.current.action;

                    var renderPath = (typeof renderAction === 'undefined' ? 'home' : renderAction.split( '.' )[0]);

                    var isHome = (renderPath == 'home');
                    var isEntry = (renderPath == 'vehicle-entry');
                    var isCourts = (renderPath == 'tennis-courts');
                    var isFacilities = (renderPath == 'facilities');

                    $scope.renderAction = renderAction;
                    $scope.renderPath = renderPath;
                    $scope.isHome = isHome;
                    $scope.isEntry = isEntry;
                    $scope.isCourts = isCourts;
                    $scope.isFacilities = isFacilities;
                    $scope.initGadget(renderPath);

                };

                $scope.$on(
                    '$routeChangeSuccess',
                    function( $currentRoute, $previousRoute ){

                        // Update the rendering.
                        render();

                    }
                );
            });

            kioskApp.run(function($rootScope) {
                $rootScope.initGadget = function(path) {

                    if (path != 'home') {
                        switch (path) {
                            case 'vehicle-entry':
                                productID = '67625';
                                break;
                            case 'tennis-courts':
                                productID = '67622';
                                break
                            case 'facilities':
                                productID = '65345';
                        }

                        document.getElementById('bookeasy__details-gadget').innerHTML = '';

                        $w(function() {

                            // load details gadget
                            BE.gadget.details('#bookeasy__details-gadget', {
                                defaultDate: new Date(),
                                descriptionHover: true,
                                period: 1,
                                productID: productID,
                                showHoverInline: true,
                                showQuantity: false,
                                thumbsInGrid: true,
                                type: 'tours',
                                vcID: 188
                            });

                        });
                    }

                }
            });

        </script>

    </body>
</html>
